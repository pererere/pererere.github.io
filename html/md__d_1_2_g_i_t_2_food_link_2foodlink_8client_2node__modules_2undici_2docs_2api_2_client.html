<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FoodLink: Class: Client</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FoodLink
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__d_1_2_g_i_t_2_food_link_2foodlink_8client_2node__modules_2undici_2docs_2api_2_client.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Class: Client</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md21260"></a></p>
<p>Extends: <code>undici.Dispatcher</code></p>
<p>A basic HTTP/1.1 client, mapped on top a single TCP/TLS connection. Pipelining is disabled by default.</p>
<p>Requests are not guaranteed to be dispatched in order of invocation.</p>
<h1><a class="anchor" id="autotoc_md21261"></a>
<code>new Client(url[, options])</code></h1>
<p>Arguments:</p>
<ul>
<li><b>url</b> <code>URL | string</code> - Should only include the <b>protocol, hostname, and port</b>.</li>
<li><b>options</b> <code>ClientOptions</code> (optional)</li>
</ul>
<p>Returns: <code>Client</code></p>
<h2><a class="anchor" id="autotoc_md21262"></a>
Parameter: <code>ClientOptions</code></h2>
<blockquote class="doxtable">
<p>⚠️ Warning: The <code>H2</code> support is experimental. </p>
</blockquote>
<ul>
<li><b>bodyTimeout</b> <code>number | null</code> (optional) - Default: <code>300e3</code> - The timeout after which a request will time out, in milliseconds. Monitors time between receiving body data. Use <code>0</code> to disable it entirely. Defaults to 300 seconds.</li>
<li><b>headersTimeout</b> <code>number | null</code> (optional) - Default: <code>300e3</code> - The amount of time, in milliseconds, the parser will wait to receive the complete HTTP headers while not sending the request. Defaults to 300 seconds.</li>
<li><b>keepAliveMaxTimeout</b> <code>number | null</code> (optional) - Default: <code>600e3</code> - The maximum allowed <code>keepAliveTimeout</code>, in milliseconds, when overridden by <em>keep-alive</em> hints from the server. Defaults to 10 minutes.</li>
<li><b>keepAliveTimeout</b> <code>number | null</code> (optional) - Default: <code>4e3</code> - The timeout, in milliseconds, after which a socket without active requests will time out. Monitors time between activity on a connected socket. This value may be overridden by <em>keep-alive</em> hints from the server. See <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Keep-Alive#directives">MDN: HTTP - Headers - Keep-Alive directives</a> for more details. Defaults to 4 seconds.</li>
<li><b>keepAliveTimeoutThreshold</b> <code>number | null</code> (optional) - Default: <code>1e3</code> - A number of milliseconds subtracted from server <em>keep-alive</em> hints when overriding <code>keepAliveTimeout</code> to account for timing inaccuracies caused by e.g. transport latency. Defaults to 1 second.</li>
<li><b>maxHeaderSize</b> <code>number | null</code> (optional) - Default: <code>--max-http-header-size</code> or <code>16384</code> - The maximum length of request headers in bytes. Defaults to Node.js' &ndash;max-http-header-size or 16KiB.</li>
<li><b>maxResponseSize</b> <code>number | null</code> (optional) - Default: <code>-1</code> - The maximum length of response body in bytes. Set to <code>-1</code> to disable.</li>
<li><b>pipelining</b> <code>number | null</code> (optional) - Default: <code>1</code> - The amount of concurrent requests to be sent over the single TCP/TLS connection according to <a href="https://tools.ietf.org/html/rfc7230#section-6.3.2">RFC7230</a>. Carefully consider your workload and environment before enabling concurrent requests as pipelining may reduce performance if used incorrectly. Pipelining is sensitive to network stack settings as well as head of line blocking caused by e.g. long running requests. Set to <code>0</code> to disable keep-alive connections.</li>
<li><b>connect</b> <code>ConnectOptions | Function | null</code> (optional) - Default: <code>null</code>.</li>
<li><b>strictContentLength</b> <code>Boolean</code> (optional) - Default: <code>true</code> - Whether to treat request content length mismatches as errors. If true, an error is thrown when the request content-length header doesn't match the length of the request body.</li>
<li><b>interceptors</b> <code>{ Client: DispatchInterceptor[] }</code> - Default: <code>[RedirectInterceptor]</code> - A list of interceptors that are applied to the dispatch method. Additional logic can be applied (such as, but not limited to: 302 status code handling, authentication, cookies, compression and caching). Note that the behavior of interceptors is Experimental and might change at any given time.</li>
<li><b>autoSelectFamily</b>: <code>boolean</code> (optional) - Default: depends on local Node version, on Node 18.13.0 and above is <code>false</code>. Enables a family autodetection algorithm that loosely implements section 5 of <a href="https://tools.ietf.org/html/rfc8305#section-5">RFC 8305</a>. See <a href="https://nodejs.org/api/net.html#socketconnectoptions-connectlistener">here</a> for more details. This option is ignored if not supported by the current Node version.</li>
<li><b>autoSelectFamilyAttemptTimeout</b>: <code>number</code> - Default: depends on local Node version, on Node 18.13.0 and above is <code>250</code>. The amount of time in milliseconds to wait for a connection attempt to finish before trying the next address when using the <code>autoSelectFamily</code> option. See <a href="https://nodejs.org/api/net.html#socketconnectoptions-connectlistener">here</a> for more details.</li>
<li><b>allowH2</b>: <code>boolean</code> - Default: <code>false</code>. Enables support for H2 if the server has assigned bigger priority to it through ALPN negotiation.</li>
<li><b>maxConcurrentStreams</b>: <code>number</code> - Default: <code>100</code>. Dictates the maximum number of concurrent streams for a single H2 session. It can be overriden by a SETTINGS remote frame.</li>
</ul>
<h3><a class="anchor" id="autotoc_md21263"></a>
Parameter: <code>ConnectOptions</code></h3>
<p>Every Tls option, see <a href="https://nodejs.org/api/tls.html#tls_tls_connect_options_callback">here</a>. Furthermore, the following options can be passed:</p>
<ul>
<li><b>socketPath</b> <code>string | null</code> (optional) - Default: <code>null</code> - An IPC endpoint, either Unix domain socket or Windows named pipe.</li>
<li><b>maxCachedSessions</b> <code>number | null</code> (optional) - Default: <code>100</code> - Maximum number of TLS cached sessions. Use 0 to disable TLS session caching. Default: 100.</li>
<li><b>timeout</b> <code>number | null</code> (optional) - In milliseconds, Default <code>10e3</code>.</li>
<li><b>servername</b> <code>string | null</code> (optional)</li>
<li><b>keepAlive</b> <code>boolean | null</code> (optional) - Default: <code>true</code> - TCP keep-alive enabled</li>
<li><b>keepAliveInitialDelay</b> <code>number | null</code> (optional) - Default: <code>60000</code> - TCP keep-alive interval for the socket in milliseconds</li>
</ul>
<h2><a class="anchor" id="autotoc_md21264"></a>
Example - Basic Client instantiation</h2>
<p>This will instantiate the undici Client, but it will not connect to the origin until something is queued. Consider using <code>client.connect</code> to prematurely connect to the origin, or just call <code>client.request</code>.</p>
<div class="fragment"><div class="line">&#39;use strict&#39;</div>
<div class="line">import { Client } from &#39;undici&#39;</div>
<div class="line"> </div>
<div class="line">const client = new Client(&#39;http://localhost:3000&#39;)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md21265"></a>
Example - Custom connector</h2>
<p>This will allow you to perform some additional check on the socket that will be used for the next request.</p>
<div class="fragment"><div class="line">&#39;use strict&#39;</div>
<div class="line">import { Client, buildConnector } from &#39;undici&#39;</div>
<div class="line"> </div>
<div class="line">const connector = buildConnector({ rejectUnauthorized: false })</div>
<div class="line">const client = new Client(&#39;https://localhost:3000&#39;, {</div>
<div class="line">  connect (opts, cb) {</div>
<div class="line">    connector(opts, (err, socket) =&gt; {</div>
<div class="line">      if (err) {</div>
<div class="line">        cb(err)</div>
<div class="line">      } else if (/* assertion */) {</div>
<div class="line">        socket.destroy()</div>
<div class="line">        cb(new Error(&#39;kaboom&#39;))</div>
<div class="line">      } else {</div>
<div class="line">        cb(null, socket)</div>
<div class="line">      }</div>
<div class="line">    })</div>
<div class="line">  }</div>
<div class="line">})</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md21266"></a>
Instance Methods</h1>
<h2><a class="anchor" id="autotoc_md21267"></a>
<code>Client.close([callback])</code></h2>
<p>Implements <a href="Dispatcher.md#dispatcherclosecallback-promise"><code>Dispatcher.close([callback])</code></a>.</p>
<h2><a class="anchor" id="autotoc_md21268"></a>
<code>Client.destroy([error, callback])</code></h2>
<p>Implements <a href="Dispatcher.md#dispatcherdestroyerror-callback-promise"><code>Dispatcher.destroy([error, callback])</code></a>.</p>
<p>Waits until socket is closed before invoking the callback (or returning a promise if no callback is provided).</p>
<h2><a class="anchor" id="autotoc_md21269"></a>
<code>Client.connect(options[, callback])</code></h2>
<p>See <a href="Dispatcher.md#dispatcherconnectoptions-callback"><code>Dispatcher.connect(options[, callback])</code></a>.</p>
<h2><a class="anchor" id="autotoc_md21270"></a>
<code>Client.dispatch(options, handlers)</code></h2>
<p>Implements <a href="Dispatcher.md#dispatcherdispatchoptions-handler"><code>Dispatcher.dispatch(options, handlers)</code></a>.</p>
<h2><a class="anchor" id="autotoc_md21271"></a>
<code>Client.pipeline(options, handler)</code></h2>
<p>See <a href="Dispatcher.md#dispatcherpipelineoptions-handler"><code>Dispatcher.pipeline(options, handler)</code></a>.</p>
<h2><a class="anchor" id="autotoc_md21272"></a>
<code>Client.request(options[, callback])</code></h2>
<p>See <a href="Dispatcher.md#dispatcherrequestoptions-callback"><code>Dispatcher.request(options [, callback])</code></a>.</p>
<h2><a class="anchor" id="autotoc_md21273"></a>
<code>Client.stream(options, factory[, callback])</code></h2>
<p>See <a href="Dispatcher.md#dispatcherstreamoptions-factory-callback"><code>Dispatcher.stream(options, factory[, callback])</code></a>.</p>
<h2><a class="anchor" id="autotoc_md21274"></a>
<code>Client.upgrade(options[, callback])</code></h2>
<p>See <a href="Dispatcher.md#dispatcherupgradeoptions-callback"><code>Dispatcher.upgrade(options[, callback])</code></a>.</p>
<h1><a class="anchor" id="autotoc_md21275"></a>
Instance Properties</h1>
<h2><a class="anchor" id="autotoc_md21276"></a>
<code>Client.closed</code></h2>
<ul>
<li><code>boolean</code></li>
</ul>
<p><code>true</code> after <code>client.close()</code> has been called.</p>
<h2><a class="anchor" id="autotoc_md21277"></a>
<code>Client.destroyed</code></h2>
<ul>
<li><code>boolean</code></li>
</ul>
<p><code>true</code> after <code>client.destroyed()</code> has been called or <code>client.close()</code> has been called and the client shutdown has completed.</p>
<h2><a class="anchor" id="autotoc_md21278"></a>
<code>Client.pipelining</code></h2>
<ul>
<li><code>number</code></li>
</ul>
<p>Property to get and set the pipelining factor.</p>
<h1><a class="anchor" id="autotoc_md21279"></a>
Instance Events</h1>
<h2><a class="anchor" id="autotoc_md21280"></a>
Event: &lsquo;'connect&rsquo;`</h2>
<p>See <a href="Dispatcher.md#event-connect">Dispatcher Event: &lsquo;'connect&rsquo;`</a>.</p>
<p>Parameters:</p>
<ul>
<li><b>origin</b> <code>URL</code></li>
<li><b>targets</b> <code>Array&lt;Dispatcher&gt;</code></li>
</ul>
<p>Emitted when a socket has been created and connected. The client will connect once <code>client.size &gt; 0</code>.</p>
<h3><a class="anchor" id="autotoc_md21281"></a>
Example - Client connect event</h3>
<div class="fragment"><div class="line">import { createServer } from &#39;http&#39;</div>
<div class="line">import { Client } from &#39;undici&#39;</div>
<div class="line">import { once } from &#39;events&#39;</div>
<div class="line"> </div>
<div class="line">const server = createServer((request, response) =&gt; {</div>
<div class="line">  response.end(&#39;Hello, World!&#39;)</div>
<div class="line">}).listen()</div>
<div class="line"> </div>
<div class="line">await once(server, &#39;listening&#39;)</div>
<div class="line"> </div>
<div class="line">const client = new Client(`http://localhost:${server.address().port}`)</div>
<div class="line"> </div>
<div class="line">client.on(&#39;connect&#39;, (origin) =&gt; {</div>
<div class="line">  console.log(`Connected to ${origin}`) // should print before the request body statement</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">try {</div>
<div class="line">  const { body } = await client.request({</div>
<div class="line">    path: &#39;/&#39;,</div>
<div class="line">    method: &#39;GET&#39;</div>
<div class="line">  })</div>
<div class="line">  body.setEncoding(&#39;utf-8&#39;)</div>
<div class="line">  body.on(&#39;data&#39;, console.log)</div>
<div class="line">  client.close()</div>
<div class="line">  server.close()</div>
<div class="line">} catch (error) {</div>
<div class="line">  console.error(error)</div>
<div class="line">  client.close()</div>
<div class="line">  server.close()</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md21282"></a>
Event: &lsquo;'disconnect&rsquo;`</h2>
<p>See <a href="Dispatcher.md#event-disconnect">Dispatcher Event: &lsquo;'disconnect&rsquo;`</a>.</p>
<p>Parameters:</p>
<ul>
<li><b>origin</b> <code>URL</code></li>
<li><b>targets</b> <code>Array&lt;Dispatcher&gt;</code></li>
<li><b>error</b> <code>Error</code></li>
</ul>
<p>Emitted when socket has disconnected. The error argument of the event is the error which caused the socket to disconnect. The client will reconnect if or once <code>client.size &gt; 0</code>.</p>
<h3><a class="anchor" id="autotoc_md21283"></a>
Example - Client disconnect event</h3>
<div class="fragment"><div class="line">import { createServer } from &#39;http&#39;</div>
<div class="line">import { Client } from &#39;undici&#39;</div>
<div class="line">import { once } from &#39;events&#39;</div>
<div class="line"> </div>
<div class="line">const server = createServer((request, response) =&gt; {</div>
<div class="line">  response.destroy()</div>
<div class="line">}).listen()</div>
<div class="line"> </div>
<div class="line">await once(server, &#39;listening&#39;)</div>
<div class="line"> </div>
<div class="line">const client = new Client(`http://localhost:${server.address().port}`)</div>
<div class="line"> </div>
<div class="line">client.on(&#39;disconnect&#39;, (origin) =&gt; {</div>
<div class="line">  console.log(`Disconnected from ${origin}`)</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">try {</div>
<div class="line">  await client.request({</div>
<div class="line">    path: &#39;/&#39;,</div>
<div class="line">    method: &#39;GET&#39;</div>
<div class="line">  })</div>
<div class="line">} catch (error) {</div>
<div class="line">  console.error(error.message)</div>
<div class="line">  client.close()</div>
<div class="line">  server.close()</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md21284"></a>
Event: &lsquo;'drain&rsquo;`</h2>
<p>Emitted when pipeline is no longer busy.</p>
<p>See <a href="Dispatcher.md#event-drain">Dispatcher Event: &lsquo;'drain&rsquo;`</a>.</p>
<h3><a class="anchor" id="autotoc_md21285"></a>
Example - Client drain event</h3>
<div class="fragment"><div class="line">import { createServer } from &#39;http&#39;</div>
<div class="line">import { Client } from &#39;undici&#39;</div>
<div class="line">import { once } from &#39;events&#39;</div>
<div class="line"> </div>
<div class="line">const server = createServer((request, response) =&gt; {</div>
<div class="line">  response.end(&#39;Hello, World!&#39;)</div>
<div class="line">}).listen()</div>
<div class="line"> </div>
<div class="line">await once(server, &#39;listening&#39;)</div>
<div class="line"> </div>
<div class="line">const client = new Client(`http://localhost:${server.address().port}`)</div>
<div class="line"> </div>
<div class="line">client.on(&#39;drain&#39;, () =&gt; {</div>
<div class="line">  console.log(&#39;drain event&#39;)</div>
<div class="line">  client.close()</div>
<div class="line">  server.close()</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">const requests = [</div>
<div class="line">  client.request({ path: &#39;/&#39;, method: &#39;GET&#39; }),</div>
<div class="line">  client.request({ path: &#39;/&#39;, method: &#39;GET&#39; }),</div>
<div class="line">  client.request({ path: &#39;/&#39;, method: &#39;GET&#39; })</div>
<div class="line">]</div>
<div class="line"> </div>
<div class="line">await Promise.all(requests)</div>
<div class="line"> </div>
<div class="line">console.log(&#39;requests completed&#39;)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md21286"></a>
Event: &lsquo;'error&rsquo;`</h2>
<p>Invoked for users errors such as throwing in the <code>onError</code> handler. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
