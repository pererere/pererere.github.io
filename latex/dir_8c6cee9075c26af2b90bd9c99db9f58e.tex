\doxysection{D\+:/\+GIT/\+Food\+Link/foodlink.client/node\+\_\+modules/needle Directory Reference}
\hypertarget{dir_8c6cee9075c26af2b90bd9c99db9f58e}{}\label{dir_8c6cee9075c26af2b90bd9c99db9f58e}\index{D:/GIT/FoodLink/foodlink.client/node\_modules/needle Directory Reference@{D:/GIT/FoodLink/foodlink.client/node\_modules/needle Directory Reference}}


\doxysubsection{Detailed Description}
\href{https://nodei.co/npm/needle/}{\texttt{ }}~\newline


\href{http://npm-stat.com/charts.html?package=needle}{\texttt{ }} 

The leanest and most handsome HTTP client in the Nodelands.


\begin{DoxyCode}{0}
\DoxyCodeLine{var\ needle\ =\ require('needle');}
\DoxyCodeLine{}
\DoxyCodeLine{needle.get('http://www.google.com',\ function(error,\ response)\ \{}
\DoxyCodeLine{\ \ if\ (!error\ \&\&\ response.statusCode\ ==\ 200)}
\DoxyCodeLine{\ \ \ \ console.log(response.body);}
\DoxyCodeLine{\});}

\end{DoxyCode}


Callbacks not floating your boat? Needle got your back.


\begin{DoxyCode}{0}
\DoxyCodeLine{\ js}
\DoxyCodeLine{var\ data\ =\ \{}
\DoxyCodeLine{\ \ file:\ '/home/johnlennon/walrus.png',}
\DoxyCodeLine{\ \ content\_type:\ 'image/png'}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{//\ the\ callback\ is\ optional,\ and\ needle\ returns\ a\ \`{}readableStream`\ object}
\DoxyCodeLine{//\ that\ triggers\ a\ 'done'\ event\ when\ the\ request/response\ process\ is\ complete.}
\DoxyCodeLine{needle}
\DoxyCodeLine{\ \ .post('https://my.server.com/foo',\ data,\ \{\ multipart:\ true\ \})}
\DoxyCodeLine{\ \ .on('readable',\ function()\ \{\ /*\ eat\ your\ chunks\ */\ \})}
\DoxyCodeLine{\ \ .on('done',\ function(err)\ \{}
\DoxyCodeLine{\ \ \ \ console.log('Ready-\/o!');}
\DoxyCodeLine{\ \ \})}

\end{DoxyCode}


From version 2.\+0.\+x up, Promises are also supported. Just call {\ttfamily needle()} directly and you\textquotesingle{}ll get a native Promise object.


\begin{DoxyCode}{0}
\DoxyCodeLine{needle('put',\ 'https://hacking.the.gibson/login',\ \{\ password:\ 'god'\ \},\ \{\ json:\ true\ \})}
\DoxyCodeLine{\ \ .then(function(response)\ \{}
\DoxyCodeLine{\ \ \ \ return\ doSomethingWith(response)}
\DoxyCodeLine{\ \ \})}
\DoxyCodeLine{\ \ .catch(function(err)\ \{}
\DoxyCodeLine{\ \ \ \ console.log('Call\ the\ locksmith!')}
\DoxyCodeLine{\ \ \})}

\end{DoxyCode}


With only two real dependencies, Needle supports\+:


\begin{DoxyItemize}
\item HTTP/\+HTTPS requests, with the usual verbs you would expect
\item All of Node\textquotesingle{}s native TLS options, such as \textquotesingle{}reject\+Unauthorized\textquotesingle{} (see below)
\item Basic \& Digest authentication with auto-\/detection
\item Multipart form-\/data (e.\+g. file uploads)
\item HTTP Proxy forwarding, optionally with authentication
\item Streaming gzip, deflate, and brotli decompression
\item Automatic XML \& JSON parsing
\item 301/302/303 redirect following, with fine-\/grained tuning, and
\item Streaming non-\/\+UTF-\/8 charset decoding, via {\ttfamily iconv-\/lite}
\item Aborting any or all Needle requests using {\ttfamily Abort\+Signal} objects
\end{DoxyItemize}

And yes, Mr. Wayne, it does come in black.

This makes Needle an ideal alternative for performing quick HTTP requests in Node, either for API interaction, downloading or uploading streams of data, and so on. If you need OAuth, AWS support or anything fancier, you should check out mikeal\textquotesingle{}s request module.\hypertarget{README.md_autotoc_md14641}{}\doxysubsection{\texorpdfstring{Install}{Install}}\label{README.md_autotoc_md14641}

\begin{DoxyCode}{0}
\DoxyCodeLine{\$\ npm\ install\ needle}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14642}{}\doxysubsection{\texorpdfstring{Usage}{Usage}}\label{README.md_autotoc_md14642}

\begin{DoxyCode}{0}
\DoxyCodeLine{//\ using\ promises}
\DoxyCodeLine{needle('get',\ 'https://server.com/posts/123')}
\DoxyCodeLine{\ \ .then(function(resp)\ \{}
\DoxyCodeLine{\ \ \ \ //\ ...}
\DoxyCodeLine{\ \ \})}
\DoxyCodeLine{\ \ .catch(function(err)\ \{}
\DoxyCodeLine{\ \ \ \ //\ ...}
\DoxyCodeLine{\ \ \});}
\DoxyCodeLine{}
\DoxyCodeLine{//\ with\ callback}
\DoxyCodeLine{needle.get('ifconfig.me/all.json',\ function(error,\ response,\ body)\ \{}
\DoxyCodeLine{\ \ if\ (error)\ throw\ error;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ body\ is\ an\ alias\ for\ \`{}response.body`,}
\DoxyCodeLine{\ \ //\ that\ in\ this\ case\ holds\ a\ JSON-\/decoded\ object.}
\DoxyCodeLine{\ \ console.log(body.ip\_addr);}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{//\ no\ callback,\ using\ streams}
\DoxyCodeLine{needle.get('https://google.com/images/logo.png')}
\DoxyCodeLine{\ \ .pipe(fs.createWriteStream('logo.png'))}
\DoxyCodeLine{\ \ .on('done',\ function(err)\ \{}
\DoxyCodeLine{\ \ \ \ console.log('Pipe\ finished!');}
\DoxyCodeLine{\ \ \});}

\end{DoxyCode}


As you can see, you can use Needle with Promises or without them. When using Promises or when a callback is passed, the response\textquotesingle{}s body will be buffered and written to {\ttfamily response.\+body}, and the callback will be fired when all of the data has been collected and processed (e.\+g. decompressed, decoded and/or parsed).

When no callback is passed, however, the buffering logic will be skipped but the response stream will still go through Needle\textquotesingle{}s processing pipeline, so you get all the benefits of post-\/processing while keeping the streamishness we all love from Node.\hypertarget{README.md_autotoc_md14643}{}\doxysubsection{\texorpdfstring{Response pipeline}{Response pipeline}}\label{README.md_autotoc_md14643}
Depending on the response\textquotesingle{}s Content-\/\+Type, Needle will either attempt to parse JSON or XML streams, or, if a text response was received, will ensure that the final encoding you get is UTF-\/8.

You can also request a gzip/deflated/brotli response, which, if sent by the server, will be processed before parsing or decoding is performed. (Note\+: brotli is only supported on Node 10.\+16.\+0 or above, and will not be requested or processed on earlier versions.)


\begin{DoxyCode}{0}
\DoxyCodeLine{needle.get('http://stackoverflow.com/feeds',\ \{\ compressed:\ true\ \},\ function(err,\ resp)\ \{}
\DoxyCodeLine{\ \ console.log(resp.body);\ //\ this\ little\ guy\ won't\ be\ a\ Gzipped\ binary\ blob}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ but\ a\ nice\ object\ containing\ all\ the\ latest\ entries}
\DoxyCodeLine{\});}

\end{DoxyCode}


Or in anti-\/callback mode, using a few other options\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{var\ options\ =\ \{}
\DoxyCodeLine{\ \ compressed\ \ \ \ \ \ \ \ \ :\ true,\ //\ sets\ 'Accept-\/Encoding'\ to\ 'gzip,\ deflate,\ br'}
\DoxyCodeLine{\ \ follow\_max\ \ \ \ \ \ \ \ \ :\ 5,\ \ \ \ //\ follow\ up\ to\ five\ redirects}
\DoxyCodeLine{\ \ rejectUnauthorized\ :\ true\ \ //\ verify\ SSL\ certificate}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{var\ stream\ =\ needle.get('https://backend.server.com/everything.html',\ options);}
\DoxyCodeLine{}
\DoxyCodeLine{//\ read\ the\ chunks\ from\ the\ 'readable'\ event,\ so\ the\ stream\ gets\ consumed.}
\DoxyCodeLine{stream.on('readable',\ function()\ \{}
\DoxyCodeLine{\ \ while\ (data\ =\ this.read())\ \{}
\DoxyCodeLine{\ \ \ \ console.log(data.toString());}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\})}
\DoxyCodeLine{}
\DoxyCodeLine{stream.on('done',\ function(err)\ \{}
\DoxyCodeLine{\ \ //\ if\ our\ request\ had\ an\ error,\ our\ 'done'\ event\ will\ tell\ us.}
\DoxyCodeLine{\ \ if\ (!err)\ console.log('Great\ success!');}
\DoxyCodeLine{\})}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14644}{}\doxysubsection{\texorpdfstring{API}{API}}\label{README.md_autotoc_md14644}
\hypertarget{README.md_autotoc_md14645}{}\doxysubsubsection{\texorpdfstring{needle(method, url\mbox{[}, data\mbox{]}\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]}) {\ttfamily (\texorpdfstring{$>$}{>} 2.\+0.\+x)}}{needle(method, url\mbox{[}, data\mbox{]}\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]}) {\ttfamily (\texorpdfstring{$>$}{>} 2.\+0.\+x)}}}\label{README.md_autotoc_md14645}
Calling {\ttfamily needle()} directly returns a Promise. Besides {\ttfamily method} and {\ttfamily url}, all parameters are optional, although when sending a {\ttfamily post}, {\ttfamily put} or {\ttfamily patch} request you will get an error if {\ttfamily data} is not present.


\begin{DoxyCode}{0}
\DoxyCodeLine{needle('get',\ 'http://some.url.com')}
\DoxyCodeLine{\ \ .then(function(resp)\ \{\ console.log(resp.body)\ \})}
\DoxyCodeLine{\ \ .catch(function(err)\ \{\ console.error(err)\ \})}

\end{DoxyCode}


Except from the above, all of Needle\textquotesingle{}s request methods return a Readable stream, and both {\ttfamily options} and {\ttfamily callback} are optional. If passed, the callback will return three arguments\+: {\ttfamily error}, {\ttfamily response} and {\ttfamily body}, which is basically an alias for {\ttfamily response.\+body}.\hypertarget{README.md_autotoc_md14646}{}\doxysubsubsection{\texorpdfstring{needle.\+head(url\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}{needle.\+head(url\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}}\label{README.md_autotoc_md14646}

\begin{DoxyCode}{0}
\DoxyCodeLine{needle.head('https://my.backend.server.com',\ \{}
\DoxyCodeLine{\ \ open\_timeout:\ 5000\ //\ if\ we're\ not\ able\ to\ open\ a\ connection\ in\ 5\ seconds,\ boom.}
\DoxyCodeLine{\},\ function(err,\ resp)\ \{}
\DoxyCodeLine{\ \ if\ (err)}
\DoxyCodeLine{\ \ \ \ console.log('Shoot!\ Something\ is\ wrong:\ '\ +\ err.message)}
\DoxyCodeLine{\ \ else}
\DoxyCodeLine{\ \ \ \ console.log('Yup,\ still\ alive.')}
\DoxyCodeLine{\})}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14647}{}\doxysubsubsection{\texorpdfstring{needle.\+get(url\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}{needle.\+get(url\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}}\label{README.md_autotoc_md14647}

\begin{DoxyCode}{0}
\DoxyCodeLine{needle.get('google.com/search?q=syd+barrett',\ function(err,\ resp)\ \{}
\DoxyCodeLine{\ \ //\ if\ no\ http://\ is\ found,\ Needle\ will\ automagically\ prepend\ it.}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14648}{}\doxysubsubsection{\texorpdfstring{needle.\+post(url, data\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}{needle.\+post(url, data\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}}\label{README.md_autotoc_md14648}

\begin{DoxyCode}{0}
\DoxyCodeLine{var\ options\ =\ \{}
\DoxyCodeLine{\ \ headers:\ \{\ 'X-\/Custom-\/Header':\ 'Bumbaway\ atuna'\ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{needle.post('https://my.app.com/endpoint',\ 'foo=bar',\ options,\ function(err,\ resp)\ \{}
\DoxyCodeLine{\ \ //\ you\ can\ pass\ params\ as\ a\ string\ or\ as\ an\ object.}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14649}{}\doxysubsubsection{\texorpdfstring{needle.\+put(url, data\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}{needle.\+put(url, data\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}}\label{README.md_autotoc_md14649}

\begin{DoxyCode}{0}
\DoxyCodeLine{var\ nested\ =\ \{}
\DoxyCodeLine{\ \ params:\ \{}
\DoxyCodeLine{\ \ \ \ are:\ \{}
\DoxyCodeLine{\ \ \ \ \ \ also:\ 'supported'}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{needle.put('https://api.app.com/v2',\ nested,\ function(err,\ resp)\ \{}
\DoxyCodeLine{\ \ console.log('Got\ '\ +\ resp.bytes\ +\ '\ bytes.')\ //\ another\ nice\ treat\ from\ this\ handsome\ fella.}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14650}{}\doxysubsubsection{\texorpdfstring{needle.\+patch(url, data\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}{needle.\+patch(url, data\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}}\label{README.md_autotoc_md14650}
Same behaviour as PUT.\hypertarget{README.md_autotoc_md14651}{}\doxysubsubsection{\texorpdfstring{needle.\+delete(url, data\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}{needle.\+delete(url, data\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}}\label{README.md_autotoc_md14651}

\begin{DoxyCode}{0}
\DoxyCodeLine{var\ options\ =\ \{}
\DoxyCodeLine{\ \ username:\ 'fidelio',}
\DoxyCodeLine{\ \ password:\ 'x'}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{needle.delete('https://api.app.com/messages/123',\ null,\ options,\ function(err,\ resp)\ \{}
\DoxyCodeLine{\ \ //\ in\ this\ case,\ data\ may\ be\ null,\ but\ you\ need\ to\ explicity\ pass\ it.}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14652}{}\doxysubsubsection{\texorpdfstring{needle.\+request(method, url, data\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}{needle.\+request(method, url, data\mbox{[}, options\mbox{]}\mbox{[}, callback\mbox{]})}}\label{README.md_autotoc_md14652}
Generic request. This not only allows for flexibility, but also lets you perform a GET request with data, in which case will be appended to the request as a query string, unless you pass a {\ttfamily json\+: true} option (read below).


\begin{DoxyCode}{0}
\DoxyCodeLine{var\ params\ =\ \{}
\DoxyCodeLine{\ \ q\ \ \ \ :\ 'a\ very\ smart\ query',}
\DoxyCodeLine{\ \ page\ :\ 2}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{needle.request('get',\ 'forum.com/search',\ params,\ function(err,\ resp)\ \{}
\DoxyCodeLine{\ \ if\ (!err\ \&\&\ resp.statusCode\ ==\ 200)}
\DoxyCodeLine{\ \ \ \ console.log(resp.body);\ //\ here\ you\ go,\ mister.}
\DoxyCodeLine{\});}

\end{DoxyCode}


Now, if you set pass {\ttfamily json\+: true} among the options, Needle won\textquotesingle{}t set your params as a querystring but instead send a JSON representation of your data through the request\textquotesingle{}s body, as well as set the {\ttfamily Content-\/\+Type} and {\ttfamily Accept} headers to {\ttfamily application/json}.


\begin{DoxyCode}{0}
\DoxyCodeLine{needle.request('get',\ 'forum.com/search',\ params,\ \{\ json:\ true\ \},\ function(err,\ resp)\ \{}
\DoxyCodeLine{\ \ if\ (resp.statusCode\ ==\ 200)\ console.log('It\ worked!');}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14653}{}\doxysubsection{\texorpdfstring{Events}{Events}}\label{README.md_autotoc_md14653}
The \href{https://nodejs.org/api/stream.html\#stream_class_stream_readable}{\texttt{ Readable stream}} object returned by the above request methods emits the following events, in addition to the regular ones (e.\+g. {\ttfamily end}, {\ttfamily close}, {\ttfamily data}, {\ttfamily pipe}, {\ttfamily readable}).\hypertarget{README.md_autotoc_md14654}{}\doxysubsubsection{\texorpdfstring{Event\+: `\textquotesingle{}response'\`{}}{Event\+: `\textquotesingle{}response'\`{}}}\label{README.md_autotoc_md14654}

\begin{DoxyItemize}
\item {\ttfamily response \texorpdfstring{$<$}{<}http.\+Incoming\+Message\texorpdfstring{$>$}{>}}
\end{DoxyItemize}

Emitted when the underlying \href{https://nodejs.org/api/http.html\#http_class_http_clientrequest}{\texttt{ http.\+Client\+Request}} emits a response event. This is after the connection is established and the header received, but before any of it is processed (e.\+g. authorization required or redirect to be followed). No data has been consumed at this point.\hypertarget{README.md_autotoc_md14655}{}\doxysubsubsection{\texorpdfstring{Event\+: `\textquotesingle{}redirect'\`{}}{Event\+: `\textquotesingle{}redirect'\`{}}}\label{README.md_autotoc_md14655}

\begin{DoxyItemize}
\item {\ttfamily location \texorpdfstring{$<$}{<}String\texorpdfstring{$>$}{>}}
\end{DoxyItemize}

Indicates that the a redirect is being followed. This means that the response code was a redirect ({\ttfamily 301}, {\ttfamily 302}, {\ttfamily 303}, {\ttfamily 307}) and the given redirect options allowed following the URL received in the {\ttfamily Location} header.\hypertarget{README.md_autotoc_md14656}{}\doxysubsubsection{\texorpdfstring{Event\+: `\textquotesingle{}header'\`{}}{Event\+: `\textquotesingle{}header'\`{}}}\label{README.md_autotoc_md14656}

\begin{DoxyItemize}
\item {\ttfamily status\+Code \texorpdfstring{$<$}{<}Integer\texorpdfstring{$>$}{>}}
\item {\ttfamily headers \texorpdfstring{$<$}{<}Object\texorpdfstring{$>$}{>}}
\end{DoxyItemize}

Triggered after the header has been processed, and just before the data is to be consumed. This implies that no redirect was followed and/or authentication header was received. In other words, we got a "{}valid"{} response.\hypertarget{README.md_autotoc_md14657}{}\doxysubsubsection{\texorpdfstring{Event\+: `\textquotesingle{}done'` (previously \textquotesingle{}end')}{Event\+: `\textquotesingle{}done'` (previously \textquotesingle{}end')}}\label{README.md_autotoc_md14657}

\begin{DoxyItemize}
\item {\ttfamily exception \texorpdfstring{$<$}{<}Error\texorpdfstring{$>$}{>}} (optional)
\end{DoxyItemize}

Emitted when the request/response process has finished, either because all data was consumed or an error ocurred somewhere in between. Unlike a regular stream\textquotesingle{}s {\ttfamily end} event, Needle\textquotesingle{}s {\ttfamily done} will be fired either on success or on failure, which is why the first argument may be an Error object. In other words\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{var\ resp\ =\ needle.get('something.worthy/of/being/streamed/by/needle');}
\DoxyCodeLine{resp.pipe(someWritableStream);}
\DoxyCodeLine{}
\DoxyCodeLine{resp.on('done',\ function(err)\ \{}
\DoxyCodeLine{\ \ if\ (err)\ console.log('An\ error\ ocurred:\ '\ +\ err.message);}
\DoxyCodeLine{\ \ else\ console.log('Great\ success!');}
\DoxyCodeLine{\})}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14658}{}\doxysubsubsection{\texorpdfstring{Event\+: `\textquotesingle{}err'\`{}}{Event\+: `\textquotesingle{}err'\`{}}}\label{README.md_autotoc_md14658}

\begin{DoxyItemize}
\item {\ttfamily exception \texorpdfstring{$<$}{<}Error\texorpdfstring{$>$}{>}}
\end{DoxyItemize}

Emitted when an error ocurrs. This should only happen once in the lifecycle of a Needle request.\hypertarget{README.md_autotoc_md14659}{}\doxysubsubsection{\texorpdfstring{Event\+: `\textquotesingle{}timeout'\`{}}{Event\+: `\textquotesingle{}timeout'\`{}}}\label{README.md_autotoc_md14659}

\begin{DoxyItemize}
\item {\ttfamily type \texorpdfstring{$<$}{<}String\texorpdfstring{$>$}{>}}
\end{DoxyItemize}

Emitted when an timeout error occurs. Type can be either \textquotesingle{}open\textquotesingle{}, \textquotesingle{}response\textquotesingle{}, or \textquotesingle{}read\textquotesingle{}. This will called right before aborting the request, which will also trigger an {\ttfamily err} event, a described above, with an {\ttfamily ECONNRESET} (Socket hang up) exception.\hypertarget{README.md_autotoc_md14660}{}\doxysubsection{\texorpdfstring{Request options}{Request options}}\label{README.md_autotoc_md14660}
For information about options that\textquotesingle{}ve changed, there\textquotesingle{}s always \href{https://github.com/tomas/needle/releases}{\texttt{ the changelog}}.


\begin{DoxyItemize}
\item {\ttfamily agent} \+: Uses an \href{https://nodejs.org/api/http.html\#http_class_http_agent}{\texttt{ http.\+Agent}} of your choice, instead of the global, default one. Useful for tweaking the behaviour at the connection level, such as when doing tunneling (see below for an example).
\item {\ttfamily json} \+: When {\ttfamily true}, sets content type to {\ttfamily application/json} and sends request body as JSON string, instead of a query string.
\item {\ttfamily open\+\_\+timeout}\+: (or {\ttfamily timeout}) Returns error if connection takes longer than X milisecs to establish. Defaults to {\ttfamily 10000} (10 secs). {\ttfamily 0} means no timeout.
\item {\ttfamily response\+\_\+timeout}\+: Returns error if no response headers are received in X milisecs, counting from when the connection is opened. Defaults to {\ttfamily 0} (no response timeout).
\item {\ttfamily read\+\_\+timeout}\+: Returns error if data transfer takes longer than X milisecs, once response headers are received. Defaults to {\ttfamily 0} (no timeout).
\item {\ttfamily follow\+\_\+max} \+: (or {\ttfamily follow}) Number of redirects to follow. Defaults to {\ttfamily 0}. See below for more redirect options.
\item {\ttfamily multipart} \+: Enables multipart/form-\/data encoding. Defaults to {\ttfamily false}. Use it when uploading files.
\item {\ttfamily proxy} \+: Forwards request through HTTP(s) proxy. Eg. `proxy\+: \textquotesingle{}\href{http://user:pass@proxy.server.com:3128&rsquo;}{\texttt{ http\+://user\+:pass@proxy.\+server.\+com\+:3128'}}{\ttfamily . For more advanced proxying/tunneling use a custom}agent{\ttfamily , as described below. -\/}headers{\ttfamily \+: Object containing custom HTTP headers for request. Overrides defaults described below. -\/}auth{\ttfamily \+: Determines what to do with provided username/password. Options are}auto{\ttfamily ,}digest{\ttfamily or}basic$<$tt$>$(default).
\end{DoxyItemize}auto{\ttfamily will detect the type of authentication depending on the response headers. -\/}stream\+\_\+length{\ttfamily \+: When sending streams, this lets you manually set the Content-\/\+Length header -\/-\/if the stream\textquotesingle{}s bytecount is known beforehand-\/-\/, preventing ECONNRESET (socket hang up) errors on some servers that misbehave when receiving payloads of unknown size. Set it to}0{\ttfamily and Needle will get and set the stream\textquotesingle{}s length for you, or leave unset for the default behaviour, which is no Content-\/\+Length header for stream payloads. -\/}local\+Address{\ttfamily \+: \texorpdfstring{$<$}{<}string\texorpdfstring{$>$}{>}, IP address. Passed to http/https request. Local interface from which the request should be emitted. -\/}uri\+\_\+modifier{\ttfamily \+: Anonymous function taking request (or redirect location if following redirects) URI as an argument and modifying it given logic. It has to return a valid URI string for successful request. -\/}signal{\ttfamily \+: An}Abort\+Signal\`{} object that can be used to abort any or all Needle requests.\hypertarget{README.md_autotoc_md14661}{}\doxysubsection{\texorpdfstring{Response options}{Response options}}\label{README.md_autotoc_md14661}

\begin{DoxyItemize}
\item {\ttfamily decode\+\_\+response} \+: (or {\ttfamily decode}) Whether to decode the text responses to UTF-\/8, if Content-\/\+Type header shows a different charset. Defaults to {\ttfamily true}.
\item {\ttfamily parse\+\_\+response} \+: (or {\ttfamily parse}) Whether to parse XML or JSON response bodies automagically. Defaults to {\ttfamily true}. You can also set this to \textquotesingle{}xml\textquotesingle{} or \textquotesingle{}json\textquotesingle{} in which case Needle will {\itshape only} parse the response if the content type matches.
\item {\ttfamily output} \+: Dump response output to file. This occurs after parsing and charset decoding is done.
\item {\ttfamily parse\+\_\+cookies} \+: Whether to parse response’s {\ttfamily Set-\/\+Cookie} header. Defaults to {\ttfamily true}. If parsed, response cookies will be available at {\ttfamily resp.\+cookies}.
\end{DoxyItemize}\hypertarget{README.md_autotoc_md14662}{}\doxysubsection{\texorpdfstring{HTTP Header options}{HTTP Header options}}\label{README.md_autotoc_md14662}
These are basically shortcuts to the {\ttfamily headers} option described above.


\begin{DoxyItemize}
\item {\ttfamily cookies} \+: Builds and sets a Cookie header from a `\{ key\+: \textquotesingle{}value' \}{\ttfamily object. -\/}compressed{\ttfamily \+: If}true`, sets \textquotesingle{}Accept-\/\+Encoding' header to \textquotesingle{}gzip,deflate\textquotesingle{}, and inflates content if zipped. Defaults to {\ttfamily false}.
\item {\ttfamily username} \+: For HTTP basic auth.
\item {\ttfamily password} \+: For HTTP basic auth. Requires username to be passed, but is optional.
\item {\ttfamily accept} \+: Sets \textquotesingle{}Accept\textquotesingle{} HTTP header. Defaults to {\ttfamily \texorpdfstring{$\ast$}{*}/\texorpdfstring{$\ast$}{*}}.
\item {\ttfamily connection}\+: Sets \textquotesingle{}Connection\textquotesingle{} HTTP header. Not set by default, unless running Node \texorpdfstring{$<$}{<} 0.\+11.\+4 in which case it defaults to {\ttfamily close}. More info about this below.
\item {\ttfamily user\+\_\+agent}\+: Sets the \textquotesingle{}User-\/\+Agent\textquotesingle{} HTTP header. Defaults to {\ttfamily Needle/\{version\} (Node.\+js \{node\+\_\+version\})}.
\item {\ttfamily content\+\_\+type}\+: Sets the \textquotesingle{}Content-\/\+Type\textquotesingle{} header. Unset by default, unless you\textquotesingle{}re sending data in which case it\textquotesingle{}s set accordingly to whatever is being sent ({\ttfamily application/x-\/www-\/form-\/urlencoded}, {\ttfamily application/json} or {\ttfamily multipart/form-\/data}). That is, of course, unless the option is passed, either here or through {\ttfamily options.\+headers}. You\textquotesingle{}re the boss.
\end{DoxyItemize}\hypertarget{README.md_autotoc_md14663}{}\doxysubsection{\texorpdfstring{Node.\+js TLS Options}{Node.\+js TLS Options}}\label{README.md_autotoc_md14663}
These options are passed directly to {\ttfamily https.\+request} if present. Taken from the \href{http://nodejs.org/docs/latest/api/https.html}{\texttt{ original documentation}}\+:


\begin{DoxyItemize}
\item {\ttfamily pfx} \+: Certificate, Private key and CA certificates to use for SSL.
\item {\ttfamily key} \+: Private key to use for SSL.
\item {\ttfamily passphrase} \+: A string of passphrase for the private key or pfx.
\item {\ttfamily cert} \+: Public x509 certificate to use.
\item {\ttfamily ca} \+: An authority certificate or array of authority certificates to check the remote host against.
\item {\ttfamily ciphers} \+: A string describing the ciphers to use or exclude.
\item {\ttfamily reject\+Unauthorized} \+: If true, the server certificate is verified against the list of supplied CAs. An \textquotesingle{}error\textquotesingle{} event is emitted if verification fails. Verification happens at the connection level, before the HTTP request is sent.
\item {\ttfamily secure\+Protocol} \+: The SSL method to use, e.\+g. SSLv3\+\_\+method to force SSL version 3.
\item {\ttfamily family} \+: IP address family to use when resolving host and hostname. Valid values are 4 or 6. When unspecified, both IP v4 and v6 will be used.
\end{DoxyItemize}\hypertarget{README.md_autotoc_md14664}{}\doxysubsection{\texorpdfstring{Redirect options}{Redirect options}}\label{README.md_autotoc_md14664}
These options only apply if the {\ttfamily follow\+\_\+max} (or {\ttfamily follow}) option is higher than 0.


\begin{DoxyItemize}
\item {\ttfamily follow\+\_\+set\+\_\+cookies} \+: Sends the cookies received in the {\ttfamily set-\/cookie} header as part of the following request, {\itshape if hosts match}. {\ttfamily false} by default.
\item {\ttfamily follow\+\_\+set\+\_\+referer} \+: Sets the \textquotesingle{}Referer\textquotesingle{} header to the requested URI when following a redirect. {\ttfamily false} by default.
\item {\ttfamily follow\+\_\+keep\+\_\+method} \+: If enabled, resends the request using the original verb instead of being rewritten to {\ttfamily get} with no data. {\ttfamily false} by default.
\item {\ttfamily follow\+\_\+if\+\_\+same\+\_\+host} \+: When true, Needle will only follow redirects that point to the same host as the original request. {\ttfamily false} by default.
\item {\ttfamily follow\+\_\+if\+\_\+same\+\_\+protocol} \+: When true, Needle will only follow redirects that point to the same protocol as the original request. {\ttfamily false} by default.
\item {\ttfamily follow\+\_\+if\+\_\+same\+\_\+location} \+: Unless true, Needle will not follow redirects that point to same location (as set in the response header) as the original request URL. {\ttfamily false} by default.
\end{DoxyItemize}\hypertarget{README.md_autotoc_md14665}{}\doxysubsection{\texorpdfstring{Overriding Defaults}{Overriding Defaults}}\label{README.md_autotoc_md14665}
Yes sir, we have it. Needle includes a {\ttfamily defaults()} method, that lets you override some of the defaults for all future requests. Like this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{needle.defaults(\{}
\DoxyCodeLine{\ \ open\_timeout:\ 60000,}
\DoxyCodeLine{\ \ user\_agent:\ 'MyApp/1.2.3',}
\DoxyCodeLine{\ \ parse\_response:\ false\ \});}

\end{DoxyCode}


This will override Needle\textquotesingle{}s default user agent and 10-\/second timeout, and disable response parsing, so you don\textquotesingle{}t need to pass those options in every other request.\hypertarget{README.md_autotoc_md14666}{}\doxysubsection{\texorpdfstring{More advanced Proxy support}{More advanced Proxy support}}\label{README.md_autotoc_md14666}
Since you can pass a custom HTTPAgent to Needle you can do all sorts of neat stuff. For example, if you want to use the \href{https://github.com/koichik/node-tunnel}{\texttt{ {\ttfamily tunnel}}} module for HTTPS proxying, you can do this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{var\ tunnel\ =\ require('tunnel');}
\DoxyCodeLine{var\ myAgent\ =\ tunnel.httpOverHttp(\{}
\DoxyCodeLine{\ \ proxy:\ \{\ host:\ 'localhost'\ \}}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{needle.get('foobar.com',\ \{\ agent:\ myAgent\ \});}

\end{DoxyCode}


Otherwise, you can use the \href{https://github.com/delvedor/hpagent}{\texttt{ {\ttfamily hpagent}}} package, which keeps the internal sockets alive to be reused.


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ \{\ HttpsProxyAgent\ \}\ =\ require('hpagent');}
\DoxyCodeLine{needle('get',\ 'https://localhost:9200',\ \{}
\DoxyCodeLine{\ \ agent:\ new\ HttpsProxyAgent(\{}
\DoxyCodeLine{\ \ \ \ keepAlive:\ true,}
\DoxyCodeLine{\ \ \ \ keepAliveMsecs:\ 1000,}
\DoxyCodeLine{\ \ \ \ maxSockets:\ 256,}
\DoxyCodeLine{\ \ \ \ maxFreeSockets:\ 256,}
\DoxyCodeLine{\ \ \ \ scheduling:\ 'lifo',}
\DoxyCodeLine{\ \ \ \ proxy:\ 'https://localhost:8080'}
\DoxyCodeLine{\ \ \})}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14667}{}\doxysubsection{\texorpdfstring{Regarding the \textquotesingle{}Connection\textquotesingle{} header}{Regarding the \textquotesingle{}Connection\textquotesingle{} header}}\label{README.md_autotoc_md14667}
Unless you\textquotesingle{}re running an old version of Node (\texorpdfstring{$<$}{<} 0.\+11.\+4), by default Needle won\textquotesingle{}t set the Connection header on requests, yielding Node\textquotesingle{}s default behaviour of keeping the connection alive with the target server. This speeds up immensely the process of sending several requests to the same host.

On older versions, however, this has the unwanted behaviour of preventing the runtime from exiting, either because of a bug or \textquotesingle{}feature\textquotesingle{} that was changed on 0.\+11.\+4. To overcome this Needle does set the \textquotesingle{}Connection\textquotesingle{} header to \textquotesingle{}close\textquotesingle{} on those versions, however this also means that making new requests to the same host doesn\textquotesingle{}t benefit from Keep-\/\+Alive.

So if you\textquotesingle{}re stuck on 0.\+10 or even lower and want full speed, you can simply set the Connection header to \textquotesingle{}Keep-\/\+Alive\textquotesingle{} by using `\{ connection\+: \textquotesingle{}Keep-\/\+Alive' \}{\ttfamily . Please note, though, that an event loop handler will prevent the runtime from exiting so you\textquotesingle{}ll need to manually call}process.\+exit()\`{} or the universe will collapse.

By default, Node uses \href{https://nodejs.org/api/http.html\#http_http_globalagent}{\texttt{ http.\+global\+Agent}} with {\ttfamily keep\+Alive} option set to {\ttfamily false} to send HTTP(s) requests. That\textquotesingle{}s why, by default, "{}\+Connection\+: close"{} header is sent, and the Connection is destroyed after the request.

To keep the Connection alive, you should create {\ttfamily http(s).Agent} with {\ttfamily keep\+Alive\+: true} and pass it as request option\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ keepAliveAgent\ =\ new\ require('https').Agent(\{\ keepAlive:\ true,\ keepAliveMsecs:\ 10000\ \});}
\DoxyCodeLine{needle(method,\ url,\ data,\ \{\ agent:\ keepAliveAgent\ \})}
\DoxyCodeLine{\ \ \ \ .then(function(response)\ \{\})}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14668}{}\doxysubsection{\texorpdfstring{Examples Galore}{Examples Galore}}\label{README.md_autotoc_md14668}
\hypertarget{README.md_autotoc_md14669}{}\doxysubsubsection{\texorpdfstring{HTTPS GET with Basic Auth}{HTTPS GET with Basic Auth}}\label{README.md_autotoc_md14669}

\begin{DoxyCode}{0}
\DoxyCodeLine{needle.get('https://api.server.com',\ \{\ username:\ 'you',\ password:\ 'secret'\ \},}
\DoxyCodeLine{\ \ function(err,\ resp)\ \{}
\DoxyCodeLine{\ \ \ \ //\ used\ HTTP\ auth}
\DoxyCodeLine{\});}

\end{DoxyCode}


Or use \href{http://tools.ietf.org/html/rfc1738\#section-3.1}{\texttt{ RFC-\/1738}} basic auth URL syntax\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{needle.get('https://username:password@api.server.com',\ function(err,\ resp)\ \{}
\DoxyCodeLine{\ \ \ \ //\ used\ HTTP\ auth\ from\ URL}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14670}{}\doxysubsubsection{\texorpdfstring{Digest Auth}{Digest Auth}}\label{README.md_autotoc_md14670}

\begin{DoxyCode}{0}
\DoxyCodeLine{needle.get('other.server.com',\ \{\ username:\ 'you',\ password:\ 'secret',\ auth:\ 'digest'\ \},}
\DoxyCodeLine{\ \ function(err,\ resp,\ body)\ \{}
\DoxyCodeLine{\ \ \ \ //\ needle\ prepends\ 'http://'\ to\ your\ URL,\ if\ missing}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14671}{}\doxysubsubsection{\texorpdfstring{Custom Accept header, deflate}{Custom Accept header, deflate}}\label{README.md_autotoc_md14671}

\begin{DoxyCode}{0}
\DoxyCodeLine{var\ options\ =\ \{}
\DoxyCodeLine{\ \ compressed\ :\ true,}
\DoxyCodeLine{\ \ follow\ \ \ \ \ :\ 10,}
\DoxyCodeLine{\ \ accept\ \ \ \ \ :\ 'application/vnd.github.full+json'}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{needle.get('api.github.com/users/tomas',\ options,\ function(err,\ resp,\ body)\ \{}
\DoxyCodeLine{\ \ //\ body\ will\ contain\ a\ JSON.parse(d)\ object}
\DoxyCodeLine{\ \ //\ if\ parsing\ fails,\ you'll\ simply\ get\ the\ original\ body}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14672}{}\doxysubsubsection{\texorpdfstring{GET XML object}{GET XML object}}\label{README.md_autotoc_md14672}

\begin{DoxyCode}{0}
\DoxyCodeLine{needle.get('https://news.ycombinator.com/rss',\ function(err,\ resp,\ body)\ \{}
\DoxyCodeLine{\ \ //\ you'll\ get\ a\ nice\ object\ containing\ the\ nodes\ in\ the\ RSS}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14673}{}\doxysubsubsection{\texorpdfstring{GET binary, output to file}{GET binary, output to file}}\label{README.md_autotoc_md14673}

\begin{DoxyCode}{0}
\DoxyCodeLine{needle.get('http://upload.server.com/tux.png',\ \{\ output:\ '/tmp/tux.png'\ \},\ function(err,\ resp,\ body)\ \{}
\DoxyCodeLine{\ \ //\ you\ can\ dump\ any\ response\ to\ a\ file,\ not\ only\ binaries.}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14674}{}\doxysubsubsection{\texorpdfstring{GET through proxy}{GET through proxy}}\label{README.md_autotoc_md14674}

\begin{DoxyCode}{0}
\DoxyCodeLine{needle.get('http://search.npmjs.org',\ \{\ proxy:\ 'http://localhost:1234'\ \},\ function(err,\ resp,\ body)\ \{}
\DoxyCodeLine{\ \ //\ request\ passed\ through\ proxy}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14675}{}\doxysubsubsection{\texorpdfstring{GET a very large document in a stream (from 0.\+7+)}{GET a very large document in a stream (from 0.\+7+)}}\label{README.md_autotoc_md14675}

\begin{DoxyCode}{0}
\DoxyCodeLine{var\ stream\ =\ needle.get('http://www.as35662.net/100.log');}
\DoxyCodeLine{}
\DoxyCodeLine{stream.on('readable',\ function()\ \{}
\DoxyCodeLine{\ \ var\ chunk;}
\DoxyCodeLine{\ \ while\ (chunk\ =\ this.read())\ \{}
\DoxyCodeLine{\ \ \ \ console.log('got\ data:\ ',\ chunk);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14676}{}\doxysubsubsection{\texorpdfstring{GET JSON object in a stream (from 0.\+7+)}{GET JSON object in a stream (from 0.\+7+)}}\label{README.md_autotoc_md14676}

\begin{DoxyCode}{0}
\DoxyCodeLine{var\ stream\ =\ needle.get('http://jsonplaceholder.typicode.com/db',\ \{\ parse:\ true\ \});}
\DoxyCodeLine{}
\DoxyCodeLine{stream.on('readable',\ function()\ \{}
\DoxyCodeLine{\ \ var\ node;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ our\ stream\ will\ only\ emit\ a\ single\ JSON\ root\ node.}
\DoxyCodeLine{\ \ while\ (node\ =\ this.read())\ \{}
\DoxyCodeLine{\ \ \ \ console.log('got\ data:\ ',\ node);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14677}{}\doxysubsubsection{\texorpdfstring{GET JSONStream flexible parser with search query (from 0.\+7+)}{GET JSONStream flexible parser with search query (from 0.\+7+)}}\label{README.md_autotoc_md14677}

\begin{DoxyCode}{0}
\DoxyCodeLine{\ //\ The\ 'data'\ element\ of\ this\ stream\ will\ be\ the\ string\ representation}
\DoxyCodeLine{\ //\ of\ the\ titles\ of\ all\ posts.}
\DoxyCodeLine{}
\DoxyCodeLine{needle.get('http://jsonplaceholder.typicode.com/db',\ \{\ parse:\ true\ \})}
\DoxyCodeLine{\ \ \ \ \ \ .pipe(new\ JSONStream.parse('posts.*.title'));}
\DoxyCodeLine{\ \ \ \ \ \ .on('data',\ function\ (obj)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ console.log('got\ post\ title:\ \%s',\ obj);}
\DoxyCodeLine{\ \ \ \ \ \ \});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14678}{}\doxysubsubsection{\texorpdfstring{File upload using multipart, passing file path}{File upload using multipart, passing file path}}\label{README.md_autotoc_md14678}

\begin{DoxyCode}{0}
\DoxyCodeLine{var\ data\ =\ \{}
\DoxyCodeLine{\ \ foo:\ 'bar',}
\DoxyCodeLine{\ \ image:\ \{\ file:\ '/home/tomas/linux.png',\ content\_type:\ 'image/png'\ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{needle.post('http://my.other.app.com',\ data,\ \{\ multipart:\ true\ \},\ function(err,\ resp,\ body)\ \{}
\DoxyCodeLine{\ \ //\ needle\ will\ read\ the\ file\ and\ include\ it\ in\ the\ form-\/data\ as\ binary}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14679}{}\doxysubsubsection{\texorpdfstring{Stream upload, PUT or POST}{Stream upload, PUT or POST}}\label{README.md_autotoc_md14679}

\begin{DoxyCode}{0}
\DoxyCodeLine{\ js}
\DoxyCodeLine{needle.put('https://api.app.com/v2',\ fs.createReadStream('myfile.txt'),\ function(err,\ resp,\ body)\ \{}
\DoxyCodeLine{\ \ //\ stream\ content\ is\ uploaded\ verbatim}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14680}{}\doxysubsubsection{\texorpdfstring{Multipart POST, passing data buffer}{Multipart POST, passing data buffer}}\label{README.md_autotoc_md14680}

\begin{DoxyCode}{0}
\DoxyCodeLine{var\ buffer\ =\ fs.readFileSync('/path/to/package.zip');}
\DoxyCodeLine{}
\DoxyCodeLine{var\ data\ =\ \{}
\DoxyCodeLine{\ \ zip\_file:\ \{}
\DoxyCodeLine{\ \ \ \ buffer\ \ \ \ \ \ \ :\ buffer,}
\DoxyCodeLine{\ \ \ \ filename\ \ \ \ \ :\ 'mypackage.zip',}
\DoxyCodeLine{\ \ \ \ content\_type\ :\ 'application/octet-\/stream'}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{needle.post('http://somewhere.com/over/the/rainbow',\ data,\ \{\ multipart:\ true\ \},\ function(err,\ resp,\ body)\ \{}
\DoxyCodeLine{\ \ //\ if\ you\ see,\ when\ using\ buffers\ we\ need\ to\ pass\ the\ filename\ for\ the\ multipart\ body.}
\DoxyCodeLine{\ \ //\ you\ can\ also\ pass\ a\ filename\ when\ using\ the\ file\ path\ method,\ in\ case\ you\ want\ to\ override}
\DoxyCodeLine{\ \ //\ the\ default\ filename\ to\ be\ received\ on\ the\ other\ end.}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md14681}{}\doxysubsubsection{\texorpdfstring{Multipart with custom Content-\/\+Type}{Multipart with custom Content-\/\+Type}}\label{README.md_autotoc_md14681}

\begin{DoxyCode}{0}
\DoxyCodeLine{var\ data\ =\ \{}
\DoxyCodeLine{\ \ token:\ 'verysecret',}
\DoxyCodeLine{\ \ payload:\ \{}
\DoxyCodeLine{\ \ \ \ value:\ JSON.stringify(\{\ title:\ 'test',\ version:\ 1\ \}),}
\DoxyCodeLine{\ \ \ \ content\_type:\ 'application/json'}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{needle.post('http://test.com/',\ data,\ \{\ timeout:\ 5000,\ multipart:\ true\ \},\ function(err,\ resp,\ body)\ \{}
\DoxyCodeLine{\ \ //\ in\ this\ case,\ if\ the\ request\ takes\ more\ than\ 5\ seconds}
\DoxyCodeLine{\ \ //\ the\ callback\ will\ return\ a\ [Socket\ closed]\ error}
\DoxyCodeLine{\});}

\end{DoxyCode}


For even more examples, check out the examples directory in the repo.\hypertarget{README.md_autotoc_md14682}{}\doxysubsubsection{\texorpdfstring{Testing}{Testing}}\label{README.md_autotoc_md14682}
To run tests, you need to generate a self-\/signed SSL certificate in the {\ttfamily test} directory. After cloning the repository, run the following commands\+: \begin{DoxyVerb}$ mkdir -p test/keys
$ openssl genrsa -out test/keys/ssl.key 2048
$ openssl req -new -key test/keys/ssl.key -x509 -days 999 -out test/keys/ssl.cert
\end{DoxyVerb}


Then you should be able to run {\ttfamily npm test} once you have the dependencies in place. To run the tests with debug logs, set the environment variable {\ttfamily NODE\+\_\+\+DEBUG} to {\ttfamily needle} (for example, by running {\ttfamily NODE\+\_\+\+DEBUG=needle npm test}).

\begin{quote}
Note\+: Tests currently only work on linux-\/based environments that have {\ttfamily /proc/self/fd}. They {\itshape do not} work on Mac\+OS environments. You can use Docker to run tests by creating a container and mounting the needle project directory on {\ttfamily /app} \end{quote}
\begin{DoxyVerb}docker create --name Needle -v $(pwd) -w /app -v $(pwd)/node_modules -i node:argon
\end{DoxyVerb}


Or alternatively\+: \begin{DoxyVerb}docker run -it -w /app --name Needle \
--mount type=bind,source="$(pwd)",target=/app \
node:fermium bash
\end{DoxyVerb}
\hypertarget{README.md_autotoc_md14683}{}\doxysubsection{\texorpdfstring{Credits}{Credits}}\label{README.md_autotoc_md14683}
Written by Tomás Pollak, with the help of contributors. If Needle\textquotesingle{}s of any help to you, please consider supporting its development!

\href{https://ko-fi.com/A0A0ASWH3}{\texttt{ }}\hypertarget{README.md_autotoc_md14684}{}\doxysubsection{\texorpdfstring{Copyright}{Copyright}}\label{README.md_autotoc_md14684}
(c) Fork Ltd. Licensed under the MIT license. 